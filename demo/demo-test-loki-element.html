<link rel="import" href="../../polymer/polymer.html">
<link rel="import" href="../etools-lokijs-storage.html">

<dom-module id="demo-test-loki-element">
  <template>
    <etools-lokijs-storage id="lokiStorageEl" db-name="localAppDb" idb-adapter-name="localStorageAdapter" on-loaded="handleLoaded"></etools-lokijs-storage>
  </template>

  <script>
    (function() {

      'use strict';
      Polymer({
        is: 'demo-test-loki-element',
        properties: {

        },
        _lokiDbIsLoaded: function(loaded) {
          if (loaded) {
            this.$.lokiStorageEl.removeCollection('testNewCollection');
            var newCollection = this.$.lokiStorageEl.addCollection('testNewCollection', ['id'], ['id'], null, 60000);
            this.$.lokiStorageEl.insertData(newCollection, [{id: 1, name: 'John Doe'}, {id: 2, name: 'Jane Doe'}]);
            this.$.lokiStorageEl.saveDatabase();
            console.log('loki collections: ', this.$.lokiStorageEl.getLokiDatabaseInstance(), this.$.lokiStorageEl.getLokiDatabaseInstance().getCollection('collectionsList'));
          }
        },

        handleLoaded: function(event) {
          console.log('on-loaded event', event.detail.loaded)
          this._lokiDbIsLoaded(event.detail.loaded);
        }

      });

    })();
  </script>
</dom-module>
